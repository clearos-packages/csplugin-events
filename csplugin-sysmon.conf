<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- ClearSync System Monitor Plugin Configuration -->
<plugin name="System Monitor" library="libcsplugin-sysmon.so" stack-size="65536">
  <state-file>/var/state/clearsync/csplugin-sysmon.state</state-file>

  <!-- Auto-purge TTL
       Delete "seen" alerts older than this age (in seconds, 0 = keep forever). -->
  <auto-purge-ttl max-age="0" />

  <!-- Databases -->
  <db type="sqlite" db_filename="/var/lib/csplugin-sysmon/sysmon.db" />

  <!-- Sources
       These sources are used for internally generated alert types. -->
  <source type="syslog" socket="/var/lib/csplugin-sysmon/syslog.socket" />
  <source type="syswatch" state="/var/lib/syswatch/state" />

  <!-- Alert types
       id: Unique integer (unsigned 32-bit) identifier.
     type: Alert type text tag. -->
  <types>
    <!-- Kernel events -->
    <type id="1000" type="KERN_PANIC" />

    <!-- System events -->
    <type id="2000" type="SYS_LOAD_HIGH" />

    <!-- Memory events -->
    <type id="3000" type="MEM_RAM_LOW" />
    <type id="3001" type="MEM_SWAP_HIGH" />

    <!-- Disk/volume events -->
    <type id="4000" type="VOLUME_FULL" />
    <type id="4001" type="VOLUME_ERROR" />

    <!-- Network events -->
    <type id="5000" type="NET_WAN_DOWN" />
    <type id="5001" type="MEM_WAN_ERROR" />

    <!-- User events -->
    <type id="6000" type="USER_LOGIN" />
    <type id="6001" type="USER_LOGOUT" />
    <type id="6002" type="USER_AUTH_FAIL" />
  </types>

  <!-- Internal Alerts
       These are internally generated by the plugin. -->
  <alerts>
    <alert type="USER_LOGIN" source="syslog">
      <pattern locale="en_US">
        pam_unix\(([A-z_\.-]*):session\): session opened for user (.*$)
      </pattern>
    </alert>

    <alert type="USER_LOGOUT" source="syslog">
      <pattern locale="en_US">
        pam_unix\(([A-z_\.-]*):session\): session closed for user (.*$)
      </pattern>
    </alert>

    <alert type="USER_AUTH_FAIL" source="syslog">
      <pattern locale="en_US">
        pam_unix\(([A-z_\.-]*):auth\): authentication failure;.*user=(.*$)
      </pattern>
    </alert>
  </alerts>
</plugin>
<!--
  vi: syntax=xml expandtab shiftwidth=2 softtabstop=2 tabstop=2
-->
